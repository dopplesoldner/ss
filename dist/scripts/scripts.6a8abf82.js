"use strict";angular.module("ssApp",["ngRoute","ui.bootstrap","nvd3","smart-table","firebase","ngProgress"]).run(["$rootScope","$location","ngProgressFactory",function(a,b,c){a.pb=c.createInstance(),a.$on("$routeChangeError",function(a,c,d,e){"AUTH_REQUIRED"===e&&b.path("/login")})}]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main",resolve:{init:["$location","$q","authService","apiService","chartConfigFactory",function(a,b,c,d,e){var f=b.defer(),g={};return c.firebaseAuth.$requireAuth().then(function(a){return g.currentAuth=a,d.apiData()}).then(function(a){g.apiData=a,f.resolve(g)},function(b){console.log(b),"AUTH_REQUIRED"===b&&a.path("/login"),f.reject()}),f.promise}],chartConfig:["chartConfigFactory",function(a){return a.chartConfig}]}}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl",controllerAs:"login"}).otherwise({redirectTo:"/"})}]),angular.module("ssApp").controller("MainCtrl",["$scope","$location","$timeout","chartConfig","init","authService",function(a,b,c,d,e,f){a.apiData=e.apiData,a.currentAuth=e.currentAuth,a.logout=function(){f.firebaseAuth.$unauth(),b.path("/login")},a.dataPie=[],a.dataBar=[{values:[]}],a.reviewSources=[];for(var g in a.apiData.reviewCount)a.reviewSources.push({source:g,count:a.apiData.reviewCount[g]});var h=function(){a.apiData.average.forEach(function(b){b.Sentiment>0&&a.dataBar[0].values.push({label:b.Name,value:b.Sentiment})});var b={vp:0,p:0,n:0,vn:0};a.apiData.relevance.forEach(function(a){a.Sentiment>7?b.vp+=1:a.Sentiment<7&&a.Sentiment>=5?b.p+=1:a.Sentiment<5&&a.Sentiment>=3?b.n+=1:b.vn+=1});for(g in b)a.dataPie.push({label:g,value:b[g]})},i=function(b){a.activeCategory=String(b),a.activeSubCategory="",a.rowCollection=[];var c=a.apiData.entity[b];for(var d in c){var e=c[d];for(var f in e)a.rowCollection.push({Date:e[f].Date,Text:e[f].Text,Sentiment:e[f].Sentiment,Url:e[f].Url,Source:e[f].Source})}};a.chartOptions={optionsBar:angular.copy(d.multiBarChart),optionsPie:angular.copy(d.pieChart)},h(),c(function(){i("general")})}]),angular.module("ssApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("ssApp").controller("LoginCtrl",["$scope","$location","authService","$timeout",function(a,b,c,d){a.user={email:"",password:""},a.authService=c.firebaseAuth,a.submitForm=function(){a.pb.start(),a.authService.$authWithPassword({email:a.user.email,password:a.user.password}).then(function(c){console.log("Logged in as:",c.uid),a.pb.complete(),b.path("/")})["catch"](function(b){console.error("authentication failed:",b),a.pb.complete(),a.login.authMsg="Please check your credentials and try again!",d(function(){a.login.authMsg=null},2e3)})}}]),angular.module("ssApp").filter("capitalize",function(){return function(a){return a?a.charAt(0).toUpperCase()+a.substr(1).toLowerCase():""}}),angular.module("ssApp").factory("apiService",["$http","$q","authService","$rootScope",function(a,b,c,d){var e=function(){return a.get("sentimentsearch-export.json")},f=function(){var a=b.defer(),e=new Firebase(c.url);return d.pb.start(),e.once("value",function(b){d.pb.complete(),a.resolve(b.val())},function(b){d.pb.complete(),a.reject(b.code)}),a.promise};return{getData:e,apiData:f}}]),angular.module("ssApp").service("authService",["$firebaseAuth",function(a){var b="https://sentimentsearch.firebaseio.com/jones family project",c=new Firebase(b);return{url:b,firebaseAuth:a(c)}}]),angular.module("ssApp").factory("chartConfigFactory",function(){var a={pieChart:{chart:{type:"pieChart",height:300,x:function(a){return a.label},y:function(a){return a.value},showValues:!1,valueFormat:function(a){return d3.format("03d")(a)},margin:{top:-20,right:20,bottom:-20,left:20},showLegend:!1,donut:!0,transitionDuration:500,labelSunbeamLayout:!0,deepWatchData:!0}},barChart:{chart:{type:"multiBarHorizontalChart",height:250,x:function(a){return a.label},y:function(a){return a.value},showValues:!0,showControls:!1,showLegend:!1,valueFormat:function(a){return d3.format(",.2f")(a)},transitionDuration:500}},multiBarChart:{chart:{type:"multiBarChart",height:250,margin:{top:20,right:20,bottom:60,left:60},yAxis:{axisLabel:"Number of reviews"},xAxis:{rotateLabels:-45},reduceXTicks:!1,showControls:!1,stacked:!0,x:function(a){return a.label},y:function(a){return a.value}}}};return{chartConfig:a}}),angular.module("ssApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/login.html",'<div class="block-center mt-xl wd-xl"> <!-- START panel--> <div class="panel panel-dark panel-flat"> <div class="panel-heading text-center"> <h3>SentimentSearch</h3> </div> <div class="panel-body"> <p class="text-center pv">SIGN IN TO CONTINUE.</p> <form role="form" ng-submit="submitForm(loginForm.$valid)" name="loginForm" novalidate class="form-validate mb-lg"> <div class="form-group has-feedback"> <input id="exampleInputEmail1" type="email" name="account_email" placeholder="Email address" autocomplete="on" ng-model="user.email" required class="form-control"> <span class="fa fa-envelope form-control-feedback text-muted"></span> <span ng-show="loginForm.account_email.$dirty &amp;&amp; loginForm.account_email.$error.required" class="text-danger">This field is required</span> <span ng-show="loginForm.account_email.$dirty &amp;&amp; loginForm.account_email.$error.email" class="text-danger">This field must be a valid email address</span> </div> <div class="form-group has-feedback"> <input id="exampleInputPassword1" type="password" name="account_password" placeholder="Password" ng-model="user.password" required class="form-control"> <span class="fa fa-lock form-control-feedback text-muted"></span> <span ng-show="loginForm.account_password.$dirty &amp;&amp; loginForm.account_password.$error.required" class="text-danger">This field is required</span> </div> <button type="submit" class="btn btn-block btn-primary mt-lg">Login</button> </form> <div ng-show="login.authMsg" class="alert alert-danger text-center">{{login.authMsg}}</div> </div> </div> <!-- END panel--> <div class="p-lg text-center"> <span>SentimentSearch &copy; 2015</span> </div> </div>'),a.put("views/main.html",'<div id="wrapper"> <nav class="navbar-default navbar-static-side" role="navigation"> <div class="sidebar-collapse"> <ul class="nav metismenu" id="side-menu"> <li class="nav-header"> <div class="dropdown profile-element"> <span> <img alt="image" class="img-circle" src="img/profile_small.jpg"> </span> <a data-toggle="dropdown" class="dropdown-toggle" href="#"> <span class="clear"> <span class="block m-t-xs"> <strong class="font-bold">User Name</strong> </span> </span> </a> </div> <div class="logo-element"> SS </div> </li> <li class="active"> <a href="index.html"><i class="fa fa-th-large"></i> <span class="nav-label">Overview</span></a> </li> <li> <a href="graph_morris.html"><i class="fa fa-pie-chart"></i> <span class="nav-label">Advanced</span> </a> </li> <li> <a href=""><i class="fa fa-bar-chart-o"></i> <span class="nav-label">Timeline</span></a> </li> <li> <a href="landing.html"><i class="fa fa-star"></i> <span class="nav-label">How It Works</span></a> </li> </ul> </div> </nav> <div id="page-wrapper" class="gray-bg dashbard-1"> <div class="row border-bottom"> <nav class="navbar navbar-static-top" role="navigation" style="margin-bottom: 0"> <div class="navbar-header"> <a class="navbar-minimalize minimalize-styl-2 btn btn-primary" href="#"><i class="fa fa-bars"></i> </a> <form role="search" class="navbar-form-custom" action="search_results.html"> <div class="form-group"> <input type="text" placeholder="Search for something..." class="form-control" name="top-search" id="top-search"> </div> </form> </div> <ul class="nav navbar-top-links navbar-right"> <li> <span class="m-r-sm text-muted welcome-message">Sentiment Search</span> </li> <li> <a href="login.html"> <i class="fa fa-sign-out"></i> Log out </a> </li> </ul> </nav> </div> <div class="row border-bottom white-bg dashboard-header"> <div class="col-sm-3"> <small>Last Updated: 30/11/2015</small> <ul class="list-unstyled list-group clear-list m-t"> <h4> Review Sources </h4> <li ng-repeat="s in reviewSources"> <span class="pull-right"> {{s.count}} </span> <span class="label label-success">1</span> {{s.source}} </li> </ul> </div> <div class="col-sm-6"> <div class="flot-chart dashboard-chart"> <h4> Average Sentiment </h4> <div class="col-md-12"> <nvd3 options="chartOptions.optionsBar" data="dataBar"></nvd3> </div> </div> </div> <div class="col-sm-3"> <div class="statistic-box"> <h4> Polarity Distribution </h4> <div class="row text-center"> <div class="col-lg-10"> <nvd3 options="chartOptions.optionsPie" data="dataPie"></nvd3> </div> </div> <div class="m-t"> <small>Positive: 60% | Very Positive: 18% | Negative: 12% | Very Negative: 10%</small> </div> </div> </div> </div> <div class="row"> <div class="col-lg-12"> <div class="wrapper wrapper-content"> <div class="row"> <div class="col-lg-4"> <div class="ibox float-e-margins"> <div class="ibox-title"> <h5>Most Mentioned</h5> <span class="label label-warning-light pull-right">{{numComments}} Comments</span> </div> <div class="ibox-content"> <div> <div class="feed-activity-list"> <div class="feed-element"> <a href="profile.html" class="pull-left"> <img alt="image" class="img-circle" src="images/comment.4839add2.png"> </a> <div class="media-body"> <small class="pull-right">58 Mentions</small> <strong>Food: </strong> the food was excellent. <br> <small class="text-muted">Sentiment: 8</small> </div> </div> <div class="feed-element"> <a href="profile.html" class="pull-left"> <img alt="image" class="img-circle" src="images/comment.4839add2.png"> </a> <div class="media-body"> <small class="pull-right">58 Mentions</small> <strong>Food: </strong> the food was excellent. <br> <small class="text-muted">Sentiment: 8</small> </div> </div> <div class="feed-element"> <a href="profile.html" class="pull-left"> <img alt="image" class="img-circle" src="images/comment.4839add2.png"> </a> <div class="media-body"> <small class="pull-right">58 Mentions</small> <strong>Food: </strong> the food was excellent. <br> <small class="text-muted">Sentiment: 8</small> </div> </div> <div class="feed-element"> <a href="profile.html" class="pull-left"> <img alt="image" class="img-circle" src="images/comment.4839add2.png"> </a> <div class="media-body"> <small class="pull-right">58 Mentions</small> <strong>Food: </strong> the food was excellent. <br> <small class="text-muted">Sentiment: 8</small> </div> </div> <div class="feed-element"> <a href="profile.html" class="pull-left"> <img alt="image" class="img-circle" src="images/comment.4839add2.png"> </a> <div class="media-body"> <small class="pull-right">58 Mentions</small> <strong>Food: </strong> the food was excellent. <br> <small class="text-muted">Sentiment: 8</small> </div> </div> <div class="feed-element"> <a href="profile.html" class="pull-left"> <img alt="image" class="img-circle" src="images/comment.4839add2.png"> </a> <div class="media-body"> <small class="pull-right">58 Mentions</small> <strong>Food: </strong> the food was excellent. <br> <small class="text-muted">Sentiment: 8</small> </div> </div> <div class="feed-element"> <a href="profile.html" class="pull-left"> <img alt="image" class="img-circle" src="images/comment.4839add2.png"> </a> <div class="media-body"> <small class="pull-right">58 Mentions</small> <strong>Food: </strong> the food was excellent. <br> <small class="text-muted">Sentiment: 8</small> </div> </div> </div> </div> </div> </div> </div> <div class="col-lg-8"> <div class="ibox float-e-margins"> <div class="ibox-title"> <h5>Monthly Feed</h5> <div class="ibox-tools"> <span class="label label-warning-light pull-right">{{numComments}} Comments</span> </div> </div> <div class="ibox-content"> <table st-table="displayed" st-safe-src="rowCollection" class="table table-striped"> <thead> <tr> <th class="col-md-2" st-sort="Date">Date <i class="fa fa-fw fa-sort"></i></th> <th class="col-md-6">Text</th> <th class="col-md-2" st-sort="Sentiment">Sentiment <i class="fa fa-fw fa-sort"></i></th> <th class="col-md-2">Source</th> </tr> <tbody> <tr ng-repeat="row in displayed"> <td>{{row.Date}}</td> <td>{{row.Text}}</td> <td>{{row.Sentiment}}</td> <td><a ng-href="{{row.Url}}" target="_blank">{{row.Source}}</a></td> </tr> </tbody> <tfoot> <tr> <td colspan="5" class="text-center"> <div st-pagination="" st-items-by-page="10"> </div> </td> </tr> </tfoot> </thead></table> </div> </div> </div> </div> </div> <div class="footer"> <div> <strong>Copyright</strong> Sentiment Search &copy; 2014-2015 </div> </div> </div> </div> </div> </div>'),a.put("views/partials/footer.html","<span>&copy; SentimentSearch - 2015</span>"),a.put("views/partials/top-navbar.html",'<!-- START Top Navbar--> <nav role="navigation" class="navbar topnavbar"> <!-- START navbar header--> <div class="navbar-header"> <a class="navbar-brand" href="#"> <span><h4 style="color:white">Sentiment Search</h4></span> </a> </div> <!-- END navbar header--> <!-- START Nav wrapper--> <div class="nav-wrapper"> <ul class="nav navbar-nav navbar-right"> <li><p class="nav navbar-text">{{currentAuth.passsword.email}}</p></li> <li><a href="" ng-click="logout()">Logout <em class="icon-logout"></em></a></li> </ul> </div> </nav>')}]);