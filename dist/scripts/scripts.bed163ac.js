"use strict";angular.module("ssApp",["ngRoute","ui.bootstrap","nvd3","smart-table","firebase","ngProgress"]).run(["$rootScope","$location","ngProgressFactory",function(a,b,c){a.pb=c.createInstance(),a.$on("$routeChangeError",function(a,c,d,e){"AUTH_REQUIRED"===e&&b.path("/login")})}]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main",resolve:{init:["$location","$q","authService","apiService","chartConfigFactory",function(a,b,c,d,e){var f=b.defer(),g={};return c.firebaseAuth.$requireAuth().then(function(a){return g.currentAuth=a,d.apiData()}).then(function(a){g.apiData=a,f.resolve(g)},function(b){console.log(b),"AUTH_REQUIRED"===b&&a.path("/login"),f.reject()}),f.promise}],chartConfig:["chartConfigFactory",function(a){return a.chartConfig}]}}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl",controllerAs:"login"}).otherwise({redirectTo:"/"})}]),angular.module("ssApp").controller("MainCtrl",["$scope","$location","$timeout","chartConfig","init","authService","capitalizeFilter",function(a,b,c,d,e,f,g){a.apiData=e.apiData,a.currentAuth=e.currentAuth,a.btn={mode:"Basic"},a.$watch("btn.mode",function(){console.log(a.btn.mode)}),a.data_pie=[],a.data_bar=[{values:[]}],a.data_pie_advanced=[],a.data_bar_advanced=[{values:[]}],a.reviewSources=[];for(var h in a.apiData.reviewCount)a.reviewSources.push({source:h,count:a.apiData.reviewCount[h]});a.logout=function(){f.firebaseAuth.$unauth(),b.path("/login")};var i=function(){a.apiData.average.forEach(function(b){b.Count>0&&a.data_pie.push({label:b.Name,value:b.Count}),b.Sentiment>0&&a.data_bar[0].values.push({label:b.Name,value:b.Sentiment})})},j=function(b){a.activeCategory=String(b),a.rowCollection=[];var c=a.apiData.entity[b];for(var d in c){var e=c[d];for(var f in e)a.rowCollection.push({Date:e[f].Date,Text:e[f].Text,Sentiment:e[f].Sentiment,Url:e[f].Url,Source:e[f].Source})}a.data_pie_advanced=[];for(var d in c)a.data_pie_advanced.push({label:d,value:c[d].length});a.$apply()};a.chartOptions={optionsBar:angular.copy(d.barChart),optionsBarAdvanced:angular.copy(d.barChart),optionsPie:angular.copy(d.pieChart),optionsPieAdvanced:angular.copy(d.pieChart)},a.chartOptions.optionsPie.chart.pie={dispatch:{elementClick:function(b){"Basic"===a.btn.mode&&j(b.data.label)}}},i(),c(function(){j("general")})}]),angular.module("ssApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("ssApp").controller("LoginCtrl",["$scope","$location","authService","$timeout",function(a,b,c,d){a.user={email:"",password:""},a.authService=c.firebaseAuth,a.submitForm=function(){a.pb.start(),a.authService.$authWithPassword({email:a.user.email,password:a.user.password}).then(function(c){console.log("Logged in as:",c.uid),a.pb.complete(),b.path("/")})["catch"](function(b){console.error("authentication failed:",b),a.pb.complete(),a.login.authMsg="Please check your credentials and try again!",d(function(){a.login.authMsg=null},2e3)})}}]),angular.module("ssApp").filter("capitalize",function(){return function(a){return a?a.charAt(0).toUpperCase()+a.substr(1).toLowerCase():""}}),angular.module("ssApp").factory("apiService",["$http","$q","authService","$rootScope",function(a,b,c,d){var e=function(){return a.get("sentimentsearch-export.json")},f=function(){var a=b.defer(),e=new Firebase(c.url);return d.pb.start(),e.once("value",function(b){d.pb.complete(),a.resolve(b.val())},function(b){d.pb.complete(),a.reject(b.code)}),a.promise};return{getData:e,apiData:f}}]),angular.module("ssApp").service("authService",["$firebaseAuth",function(a){var b="https://sentimentsearch.firebaseio.com/jones family project",c=new Firebase(b);return{url:b,firebaseAuth:a(c)}}]),angular.module("ssApp").factory("chartConfigFactory",function(){var a={pieChart:{chart:{type:"pieChart",height:350,x:function(a){return a.label},y:function(a){return a.value},showValues:!0,valueFormat:function(a){return d3.format("03d")(a)},transitionDuration:500,labelSunbeamLayout:!0,deepWatchData:!0}},barChart:{chart:{type:"multiBarHorizontalChart",height:250,x:function(a){return a.label},y:function(a){return a.value},showValues:!0,showControls:!1,showLegend:!1,valueFormat:function(a){return d3.format(",.2f")(a)},transitionDuration:500}}};return{chartConfig:a}}),angular.module("ssApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/login.html",'<div class="block-center mt-xl wd-xl"> <!-- START panel--> <div class="panel panel-dark panel-flat"> <div class="panel-heading text-center"> <h3>SentimentSearch</h3> </div> <div class="panel-body"> <p class="text-center pv">SIGN IN TO CONTINUE.</p> <form role="form" ng-submit="submitForm(loginForm.$valid)" name="loginForm" novalidate class="form-validate mb-lg"> <div class="form-group has-feedback"> <input id="exampleInputEmail1" type="email" name="account_email" placeholder="Email address" autocomplete="on" ng-model="user.email" required class="form-control"> <span class="fa fa-envelope form-control-feedback text-muted"></span> <span ng-show="loginForm.account_email.$dirty &amp;&amp; loginForm.account_email.$error.required" class="text-danger">This field is required</span> <span ng-show="loginForm.account_email.$dirty &amp;&amp; loginForm.account_email.$error.email" class="text-danger">This field must be a valid email address</span> </div> <div class="form-group has-feedback"> <input id="exampleInputPassword1" type="password" name="account_password" placeholder="Password" ng-model="user.password" required class="form-control"> <span class="fa fa-lock form-control-feedback text-muted"></span> <span ng-show="loginForm.account_password.$dirty &amp;&amp; loginForm.account_password.$error.required" class="text-danger">This field is required</span> </div> <button type="submit" class="btn btn-block btn-primary mt-lg">Login</button> </form> <div ng-show="login.authMsg" class="alert alert-danger text-center">{{login.authMsg}}</div> </div> </div> <!-- END panel--> <div class="p-lg text-center"> <span>SentimentSearch &copy; 2015</span> </div> </div>'),a.put("views/main.html",'<!-- top navbar--> <header ng-include="\'views/partials/top-navbar.html\'" class="topnavbar-wrapper"></header> <!-- sidebar--> <div class="container-fluid view-container"> <div class="row" style="padding-top: 10px"> <div class="col-md-9"> <h4>Jones Family Project</h4> </div> <div class="col-md-2 pull-right"> <div class="btn-group"> <label ng-model="btn.mode" uib-btn-radio="\'Basic\'" class="btn btn-pill-left btn-default">Basic</label> <label ng-model="btn.mode" uib-btn-radio="\'Advanced\'" class="btn btn-oval btn-default">Advanced</label> </div> </div> </div> <div class="row"> <div class="col-md-4"> <!-- START List group--> <ul class="list-group"> <li class="list-group-item"> <div class="row row-table pv-lg"> <div class="col-xs-6"> <p class="m0 lead">{{apiData.overall}}</p> <p class="m0"> <small>Overall Sentiment Score</small> </p> </div> <div class="col-xs-6 text-center"> <div sparkline="" data-bar-color="#23b7e5" data-height="60" data-bar-width="10" data-bar-spacing="6" data-chart-range-min="0" values="3,6,7,8,4,5" class="ng-isolate-scope"><canvas width="90" height="60" style="display: inline-block; width: 90px; height: 60px; vertical-align: top"></canvas></div> </div> </div> </li> <li class="list-group-item"> <div class="row row-table pv-lg"> <div class="col-xs-6"> <h5>Review Sources</h5> </div> <div class="col-xs-6"> <ul class="list-inline text-center"> <li ng-repeat="s in reviewSources"> <p class="m0 lead">{{s.count}}</p> <p class="m0"> <small>{{s.source}}</small> </p> </li> </ul> </div> </div> </li> </ul> <!-- END List group--> </div> <div class="col-md-8"> <!-- START bar chart--> <div id="panelChart3" class="panel"> <div class="panel-heading"> <div class="panel-title"> <div class="col-md-12"><em class="icon-bar-chart"></em> Sentiment Score per category</div> </div> </div> <!-- <div collapse="panelChart3" class="panel-wrapper collapse in graph"> --> <div class="panel-body"> <nvd3 options="chartOptions.optionsBar" data="data_bar"></nvd3> </div> </div> <!-- END bar chart--> </div> </div> <div class="row"> <div class="col-md-4"> <!-- START bar chart--> <div class="panel"> <div class="panel-heading"> <div class="panel-title"> <div class="col-md-12"><em class="icon-pie-chart"></em> Review Breakdown</div> </div> </div> <div class="panel-body"> <nvd3 options="chartOptions.optionsPie" data="data_pie"></nvd3> </div> </div> </div> <div class="col-md-8"> <div class="panel"> <div class="panel-heading"> <div class="panel-title"> <div class="col-md-12"><em class="icon-eye"></em> {{activeCategory | capitalize}}</div> </div> </div> <div class="panel-body"> <table st-table="displayed" st-safe-src="rowCollection" class="table table-striped"> <thead> <tr> <th class="col-md-2" st-sort="Date">Date <i class="fa fa-fw fa-sort"></i></th> <th class="col-md-6">Text</th> <th class="col-md-2" st-sort="Sentiment">Sentiment <i class="fa fa-fw fa-sort"></i></th> <th class="col-md-2">Source</th> </tr> <tbody> <tr ng-repeat="row in displayed"> <td>{{row.Date}}</td> <td>{{row.Text}}</td> <td>{{row.Sentiment}}</td> <td><a ng-href="{{row.Url}}" target="_blank">{{row.Source}}</a></td> </tr> </tbody> <tfoot> <tr> <td colspan="5" class="text-center"> <div st-pagination="" st-items-by-page="7"> </div> </td> </tr> </tfoot> </thead></table> <div class="col-md-6"> <nvd3 options="chartOptions.optionsPieAdvanced" data="data_pie_advanced"></nvd3> </div> <!-- <div class="col-md-6">\n                <nvd3 options="chartOptions.optionsBarAdvanced" data="data_bar_advanced"></nvd3>\n              </div> --> </div> </div> </div> </div> </div> <!-- end container --> <!-- Page footer--> <footer ng-include="\'views/partials/footer.html\'"></footer>'),a.put("views/partials/footer.html","<span>&copy; SentimentSearch - 2015</span>"),a.put("views/partials/top-navbar-h.html",'<!-- START Top Navbar--> <nav role="navigation" class="navbar topnavbar"> <!-- START navbar header--> <div class="navbar-header"> <button type="button" ng-init="navCollapsed = true" ng-click="navCollapsed = !navCollapsed" class="navbar-toggle collapsed"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a href="#/" class="navbar-brand"> <div class="brand-logo"> <img src="app/img/logo.png" alt="App Logo" class="img-responsive"> </div> <div class="brand-logo-collapsed"> <img src="app/img/logo-single.png" alt="App Logo" class="img-responsive"> </div> </a> </div> <!-- END navbar header--> <!-- START Nav wrapper--> <div collapse="navCollapsed" class="collapse navbar-collapse"> <!-- Navbar Menu --> <ul ng-controller="SidebarController" class="nav navbar-nav"> <li ng-repeat="item in menuItems | limitTo: 3 " ng-class="{\'dropdown\': item.submenu}" dropdown="!!item.submenu"> <a ng-if="!item.heading &amp;&amp; !item.submenu" ng-href="{{$state.href(item.sref)}}" title="{{item.text}}"> <span>{{(item.translate | translate) || item.text}}</span> </a> <a dropdown-toggle="" ng-if="item.submenu"> <span>{{(item.translate | translate) || item.text}}</span> </a> <!-- START Dropdown menu--> <ul class="dropdown-menu animated fadeInUp"> <li ng-repeat="subitem in item.submenu"> <a ng-href="{{$state.href(subitem.sref)}}" title="{{subitem.text}}"> <span>{{(subitem.translate | translate) || subitem.text}}</span> </a> </li> </ul> </li> </ul> <!-- End Navbar Menu--> <!-- START Right Navbar--> <ul class="nav navbar-nav navbar-right"> <!-- START lock screen--> <li> <a ui-sref="page.lock" title="Lock screen"> <em class="icon-lock"></em> </a> </li> <!-- END lock screen--> <!-- Search icon--> <li> <a href="" search-open="search-open"> <em class="icon-magnifier"></em> </a> </li> <!-- Fullscreen (only desktops)--> <li class="visible-lg"> <a href="" toggle-fullscreen="toggle-fullscreen"> <em class="fa fa-expand"></em> </a> </li> <!-- START Alert menu--> <li dropdown="" class="dropdown dropdown-list"> <a dropdown-toggle=""> <em class="icon-bell"></em> <div class="label label-danger">11</div> </a> <!-- START Dropdown menu--> <ul class="dropdown-menu animated flipInX"> <li> <!-- START list group--> <div class="list-group"> <!-- list item--> <a href="" class="list-group-item"> <div class="media-box"> <div class="pull-left"> <em class="fa fa-twitter fa-2x text-info"></em> </div> <div class="media-box-body clearfix"> <p class="m0">New followers</p> <p class="m0 text-muted"> <small>1 new follower</small> </p> </div> </div> </a> <!-- list item--> <a href="" class="list-group-item"> <div class="media-box"> <div class="pull-left"> <em class="fa fa-envelope fa-2x text-warning"></em> </div> <div class="media-box-body clearfix"> <p class="m0">New e-mails</p> <p class="m0 text-muted"> <small>You have 10 new emails</small> </p> </div> </div> </a> <!-- list item--> <a href="" class="list-group-item"> <div class="media-box"> <div class="pull-left"> <em class="fa fa-tasks fa-2x text-success"></em> </div> <div class="media-box-body clearfix"> <p class="m0">Pending Tasks</p> <p class="m0 text-muted"> <small>11 pending task</small> </p> </div> </div> </a> <!-- last list item --> <a href="" class="list-group-item"> <small translate="topbar.notification.MORE">More notifications</small> <span class="label label-danger pull-right">14</span> </a> </div> <!-- END list group--> </li> </ul> <!-- END Dropdown menu--> </li> <!-- END Alert menu--> <!-- START Contacts button--> <li> <a href="" ng-click="app.offsidebarOpen = !app.offsidebarOpen"> <em class="icon-notebook"></em> </a> </li> <!-- END Contacts menu--> </ul> <!-- END Right Navbar--> </div> <!-- END Nav wrapper--> <!-- START Search form--> <form role="search" action="search.html" class="navbar-form"> <div class="form-group has-feedback"> <input type="text" placeholder="{{ \'topbar.search.PLACEHOLDER\' | translate }}" class="form-control"> <div search-dismiss="search-dismiss" class="fa fa-times form-control-feedback"></div> </div> <button type="submit" class="hidden btn btn-default">Submit</button> </form> <!-- END Search form--> </nav> <!-- END Top Navbar-->'),a.put("views/partials/top-navbar.html",'<!-- START Top Navbar--> <nav role="navigation" class="navbar topnavbar"> <!-- START navbar header--> <div class="navbar-header"> <a href="#/" class="navbar-brand"> <div class="brand-logo"> <img src="images/logo.42826323.png" alt="App Logo" class="img-responsive"> </div> <div class="brand-logo-collapsed"> <img src="images/logo-single.bbc33603.png" alt="App Logo" class="img-responsive"> </div> </a> </div> <!-- END navbar header--> <!-- START Nav wrapper--> <div class="nav-wrapper"> <ul class="nav navbar-nav navbar-right"> <li><p class="nav navbar-text">{{currentAuth.passsword.email}}</p></li> <li><a href="" ng-click="logout()"> <em class="icon-logout"></em></a></li> </ul> </div> </nav>')}]);